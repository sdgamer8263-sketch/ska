<!-- Firebase CDN -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
/* ================= FIREBASE CONFIG ================= */
const firebaseConfig = {
  apiKey: "AIzaSyBvlOV7L3g_lBDRR7mcNincGVyM16xtd90",
  authDomain: "ska-web-168fe.firebaseapp.com",
  databaseURL: "https://ska-web-168fe-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "ska-web-168fe",
  storageBucket: "ska-web-168fe.firebasestorage.app",
  messagingSenderId: "782823377176",
  appId: "1:782823377176:web:e2f62ba16d5fe0af7f366d"
};

/* ================= INIT ================= */
if (!firebase.apps.length) {
  firebase.initializeApp(firebaseConfig);
}
const db = firebase.database();

console.log("üî• Firebase Connected");

/* ================= REGISTER ================= */
function registerUser() {
  const username = document.getElementById("regUser").value.trim();
  const email = document.getElementById("regEmail").value.trim();
  const password = document.getElementById("regPass").value.trim();

  if (!username || !email || !password) {
    alert("All fields required!");
    return;
  }

  db.ref("users").push({
    username: username,
    email: email,
    password: password
  })
  .then(() => {
    alert("‚úÖ Registration successful");
    window.location.href =
      "https://sites.google.com/view/ska-hosting67/home";
  })
  .catch((error) => {
    console.error(error);
    alert("‚ùå Register error");
  });
}

/* ================= LOGIN ================= */
function loginUser() {
  const userInput = document.getElementById("loginUser").value.trim();
  const password = document.getElementById("loginPass").value.trim();

  if (!userInput || !password) {
    alert("All fields required!");
    return;
  }

  db.ref("users").once("value", (snapshot) => {
    let found = false;

    snapshot.forEach((child) => {
      const data = child.val();
      if (
        (data.username === userInput || data.email === userInput) &&
        data.password === password
      ) {
        found = true;
      }
    });

    if (found) {
      alert("‚úÖ Login success");
      window.location.href =
        "https://sites.google.com/view/ska-hosting67/home";
    } else {
      alert("‚ùå Wrong login details");
    }
  });
}
</script>
